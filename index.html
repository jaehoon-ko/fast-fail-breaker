<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>í•­ìƒ ë¹›ë‚˜ì§€ ì•Šì•„ë„ ê´œì°®ì•„ - ë°©í•´ìš”ì¸ ë¶€ìˆ˜ê¸° ê²Œì„</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    * {
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #f5f5f5;
      padding: 16px;
    }

    .game-wrapper {
      background: #ffffff;
      border-radius: 18px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      padding: 20px;
      width: 100%;
      max-width: 520px;
      position: relative;
      overflow: hidden;
    }

    .title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 4px;
      color: #222;
    }

    .subtitle {
      font-size: 13px;
      color: #666;
      margin-bottom: 14px;
    }

    .status-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      margin-bottom: 8px;
      color: #555;
    }

    .timer {
      font-weight: 700;
      font-size: 14px;
      color: #e60012;
    }

    .best-time {
      font-size: 12px;
      color: #777;
    }

    /* ë²½ëŒ ë ˆì´ì•„ì›ƒ */
    .grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
      margin: 10px 0 14px;
    }

    .block {
      background: #f7d7aa;              /* ë²½ëŒìƒ‰ */
      border-radius: 6px;
      padding: 10px;
      border: 1px solid #e2b684;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      min-height: 70px;
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.2s ease, opacity 0.2s ease;
      position: relative;
      overflow: hidden;
    }

    /* ë²½ëŒ í‘œë©´ ëŠë‚Œ */
    .block::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(
        135deg,
        rgba(255,255,255,0.2),
        rgba(255,255,255,0) 40%,
        rgba(0,0,0,0.03) 70%
      );
      pointer-events: none;
    }

    .block:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    }

    .block:active {
      transform: translateY(0);
      box-shadow: none;
    }

    .block.disabled {
      cursor: default;
      box-shadow: none;
    }

    .block-title {
      font-size: 12px;
      font-weight: 700;
      color: #3b2a18;
      margin-bottom: 4px;
      position: relative;
      z-index: 1;
    }

    .block-progress {
      font-size: 11px;
      color: #777;
      margin-bottom: 6px;
      display: none;   /* âœ… í´ë¦­ íšŸìˆ˜ ìˆ¨ê¸°ê¸° */
    }

    .hp-bar {
      width: 100%;
      height: 6px;
      background: rgba(255,255,255,0.5);
      border-radius: 999px;
      overflow: hidden;
      position: relative;
      z-index: 1;
    }

    .hp-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #ffb347, #ff6f3c);
      transition: width 0.08s ease;
    }

    /* ê¹¨ì¡Œì„ ë•Œ ì• ë‹ˆë©”ì´ì…˜ */
    @keyframes breakBrick {
      0%   { transform: translateY(0) rotate(0deg); opacity: 1; }
      20%  { transform: translate(-2px, -2px) rotate(-2deg); }
      40%  { transform: translate(2px, 2px) rotate(2deg); }
      60%  { transform: translate(-1px, 2px) rotate(-3deg); }
      80%  { transform: translate(1px, -2px) rotate(3deg); }
      100% { transform: scale(0.8) translateY(6px); opacity: 0.1; }
    }

    .block.broken {
      animation: breakBrick 0.4s ease-out forwards;
    }

    .block.broken .block-title {
      color: #888;
    }

    .result {
      font-size: 13px;
      color: #444;
      margin-bottom: 10px;
      min-height: 18px;
    }

    .controls {
      display: flex;
      justify-content: space-between;
      gap: 10px;
    }

    button {
      border-radius: 999px;
      border: none;
      padding: 8px 14px;
      font-size: 13px;
      cursor: pointer;
      font-weight: 600;
    }

    .reset-btn {
      background: #f0f0f0;
      color: #555;
    }

    .clear-best-btn {
      background: #ffe5e8;
      color: #aa0011;
    }

    button:hover {
      opacity: 0.9;
    }

    /* "ë¹ ë¥¸ ì‹¤í–‰" íŒì—… */
    .fast-label {
      position: absolute;
      inset: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      pointer-events: none;
      animation: fastPop 0.7s ease-out forwards;
    }

    .fast-label-inner {
      background: rgba(230,0,18,0.94);
      color: #fff;
      padding: 14px 24px;
      border-radius: 999px;
      font-size: 20px;
      font-weight: 800;
      box-shadow: 0 8px 22px rgba(0,0,0,0.25);
    }

    @keyframes fastPop {
      0%   { transform: scale(0.3); opacity: 0; }
      60%  { transform: scale(1.05); opacity: 1; }
      100% { transform: scale(1); opacity: 1; }
    }

    @media (max-width: 480px) {
      .game-wrapper {
        padding: 16px;
      }

.grid {
        gap: 6px;
      }
      .block {
        min-height: 70px;
      }
    }
  </style>
</head>
<body>
  <div class="game-wrapper">
    <div class="title">ë°©í•´ìš”ì¸ ë¶€ìˆ˜ê¸° ê²Œì„</div>
    <div class="subtitle">
      ë¹ ë¥¸ ì‹¤í–‰Â·ë¹ ë¥¸ ì‹¤íŒ¨ë¥¼ ë§‰ëŠ” 9ê°œì˜ ë²½ëŒì„<br>
      <b>í´ë¦­í•´ì„œ ë¶€ì…”ë³´ì„¸ìš”! (ê° ë²½ëŒ 25í´ë¦­)</b>
    </div>

    <div class="status-bar">
      <div>âŒ› <span class="timer" id="timer">0.00s</span></div>
      <div class="best-time" id="bestTimeLabel">ìµœê³  ê¸°ë¡: -</div>
    </div>

    <div class="grid" id="blockGrid"></div>

    <div class="result" id="resultMsg"></div>

    <div class="controls">
      <button class="reset-btn" id="restartBtn">ë‹¤ì‹œ ì‹œì‘</button>
      <button class="clear-best-btn" id="clearBestBtn">ìµœê³  ê¸°ë¡ ì´ˆê¸°í™”</button>
    </div>
  </div>

  <script>
    // 1) ë¸”ë¡ í…ìŠ¤íŠ¸ (ìµœì‹  ë²„ì „)
    const blockLabels = [
      "ì™„ë²½ì£¼ì˜",
      "ëì—†ëŠ” íšŒì˜",
      "ìƒˆë¡œì›€ì— ëŒ€í•œ ë¶€ì •ì ì¸ í”¼ë“œë°±",
      "ì‹¤íŒ¨ì— ëŒ€í•œ ë‘ë ¤ì›€",
      "ëì—†ëŠ” ì„¤ë“",
      "ì±…ì„ì— ëŒ€í•œ ë¶€ë‹´",
      "ë ˆí¼ëŸ°ìŠ¤ ì—†ìœ¼ë©´ ì•ˆë¼",
      "ê³ ê°ë³´ë‹¤ ë‚´ë¶€ ì‚¬ì • ìš°ì„ ",
      "â€œë‚˜ì¤‘ì— í•˜ìâ€ ìŠµê´€"
    ];

    // âœ… í•œ ë¸”ë¡ë‹¹ í´ë¦­ íšŸìˆ˜
    const CLICKS_TO_BREAK = 25;
    const BEST_KEY = "fastFailBreaker_bestTime_v2";

    const gridEl = document.getElementById("blockGrid");
    const timerEl = document.getElementById("timer");
    const resultEl = document.getElementById("resultMsg");
    const bestTimeLabel = document.getElementById("bestTimeLabel");
    const restartBtn = document.getElementById("restartBtn");
    const clearBestBtn = document.getElementById("clearBestBtn");
    const gameWrapper = document.querySelector(".game-wrapper");

    let blocks = [];
    let startTime = null;
    let timerInterval = null;
    let gameFinished = false;

    // ìµœê³  ê¸°ë¡ í‘œì‹œ
    function loadBestTime() {
      const best = localStorage.getItem(BEST_KEY);
      if (best) {
        bestTimeLabel.textContent = `ìµœê³  ê¸°ë¡: ${Number(best).toFixed(2)}s`;
      } else {
        bestTimeLabel.textContent = "ìµœê³  ê¸°ë¡: -";
      }
    }

    // íƒ€ì´ë¨¸ ì‹œì‘
    function startTimer() {
      if (startTime !== null) return;
      startTime = performance.now();
      timerInterval = setInterval(() => {
        if (startTime === null) return;
        const elapsed = (performance.now() - startTime) / 1000;
        timerEl.textContent = `${elapsed.toFixed(2)}s`;
      }, 30);
    }

    // íƒ€ì´ë¨¸ ì •ì§€
    function stopTimer() {
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
    }

    // ëª¨ë“  ë¸”ë¡ì´ ê¹¨ì¡ŒëŠ”ì§€ í™•ì¸
    function checkAllBroken() {
      return blocks.every(b => b.clicks >= CLICKS_TO_BREAK);
    }

    // ê²Œì„ ì´ˆê¸°í™”
    function initGame() {
      stopTimer();
      startTime = null;
      gameFinished = false;
      timerEl.textContent = "0.00s";
      resultEl.textContent = "";

      // "ë¹ ë¥¸ ì‹¤í–‰" ë¼ë²¨ ì œê±°
      const oldLabel = document.querySelector(".fast-label");
      if (oldLabel) oldLabel.remove();

      gridEl.innerHTML = "";
      blocks = [];

      blockLabels.forEach((label, idx) => {
        const block = document.createElement("div");
        block.className = "block";
        block.dataset.index = idx;

        block.innerHTML = `
          <div class="block-title">${label}</div>
          <div class="block-progress">0 / ${CLICKS_TO_BREAK} í´ë¦­</div>
          <div class="hp-bar">
            <div class="hp-fill"></div>
          </div>
        `;

        const blockObj = {
          el: block,
          titleEl: block.querySelector(".block-title"),
          progressEl: block.querySelector(".block-progress"),
          hpFillEl: block.querySelector(".hp-fill"),
          clicks: 0
        };

        block.addEventListener("click", () => handleBlockClick(blockObj));

        blocks.push(blockObj);
        gridEl.appendChild(block);
      });

      loadBestTime();
    }

    // ë¸”ë¡ í´ë¦­ ì²˜ë¦¬
    function handleBlockClick(blockObj) {
      if (gameFinished) return;

      // íƒ€ì´ë¨¸ëŠ” ì²« í´ë¦­ ì‹œ ì‹œì‘
      startTimer();

      if (blockObj.clicks >= CLICKS_TO_BREAK) return;

      blockObj.clicks += 1;

      const ratio = blockObj.clicks / CLICKS_TO_BREAK;
      // í…ìŠ¤íŠ¸ëŠ” ìˆ¨ê²¨ì ¸ ìˆì§€ë§Œ ë‚´ë¶€ì ìœ¼ë¡œëŠ” ì—…ë°ì´íŠ¸
      blockObj.progressEl.textContent = `${blockObj.clicks} / ${CLICKS_TO_BREAK} í´ë¦­`;
 blockObj.hpFillEl.style.width = `${ratio * 100}%`;

      if (blockObj.clicks >= CLICKS_TO_BREAK) {
        blockObj.el.classList.add("disabled", "broken");

        // ì „ë¶€ ë‹¤ ê¹¬ ê²½ìš°
        if (checkAllBroken()) {
          finishGame();
        }
      }
    }

    // ê²Œì„ ì¢…ë£Œ ì²˜ë¦¬
    function finishGame() {
      gameFinished = true;
      stopTimer();

      const elapsed = (performance.now() - startTime) / 1000;
      const elapsedFixed = elapsed.toFixed(2);
      resultEl.textContent = `ğŸ‰ ëª¨ë“  ë°©í•´ìš”ì¸ì„ ë¶€ì‰ˆìŠµë‹ˆë‹¤! ê¸°ë¡: ${elapsedFixed}s`;

      const best = localStorage.getItem(BEST_KEY);
      if (!best || elapsed < Number(best)) {
        localStorage.setItem(BEST_KEY, elapsed);
        bestTimeLabel.textContent = `ìµœê³  ê¸°ë¡: ${elapsedFixed}s (ì‹ ê¸°ë¡!)`;
        resultEl.textContent += "  ğŸ† ì‹ ê¸°ë¡ ë‹¬ì„±!";
      }

      // âœ… "ë¹ ë¥¸ ì‹¤í–‰" ë¼ë²¨ í‘œì‹œ
      const label = document.createElement("div");
      label.className = "fast-label";
      label.innerHTML = `
        <div class="fast-label-inner">
          ë¹ ë¥¸ ì‹¤í–‰
        </div>
      `;
      gameWrapper.appendChild(label);
    }

    // ì´ë²¤íŠ¸
    restartBtn.addEventListener("click", initGame);

    clearBestBtn.addEventListener("click", () => {
      localStorage.removeItem(BEST_KEY);
      loadBestTime();
      resultEl.textContent = "ìµœê³  ê¸°ë¡ì„ ì´ˆê¸°í™”í–ˆìŠµë‹ˆë‹¤.";
    });

    // ì²« ë¡œë”©
    initGame();
  </script>
</body>
</html>
