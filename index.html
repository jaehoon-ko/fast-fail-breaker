<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>í•­ìƒ ë¹›ë‚˜ì§€ ì•Šì•„ë„ ê´œì°®ì•„ - ë°©í•´ìš”ì¸ ë¶€ìˆ˜ê¸° ê²Œì„</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    * {
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #f5f5f5;
      padding: 16px;
    }

    .game-wrapper {
      background: #ffffff;
      border-radius: 18px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      padding: 20px;
      width: 100%;
      max-width: 520px;
    }

    .title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 4px;
      color: #222;
    }

    .subtitle {
      font-size: 13px;
      color: #666;
      margin-bottom: 14px;
    }

    .status-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      margin-bottom: 8px;
      color: #555;
    }

    .timer {
      font-weight: 700;
      font-size: 14px;
      color: #e60012;
    }

    .best-time {
      font-size: 12px;
      color: #777;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin: 10px 0 14px;
    }

    .block {
      background: #fff7e6;
      border-radius: 12px;
      padding: 10px;
      border: 1px solid #f0d6a4;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      min-height: 90px;
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.2s ease;
    }

    .block:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    }

    .block:active {
      transform: translateY(0);
      box-shadow: none;
    }

    .block.disabled {
      cursor: default;
      background: #e6f7ff;
      border-color: #b7e0ff;
      box-shadow: none;
    }

    .block-title {
      font-size: 13px;
      font-weight: 700;
      color: #333;
      margin-bottom: 4px;
    }

    .block-progress {
      font-size: 11px;
      color: #777;
      margin-bottom: 6px;
    }

    .hp-bar {
      width: 100%;
      height: 6px;
      background: #ffe4b3;
      border-radius: 999px;
      overflow: hidden;
    }

    .hp-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #ff9f43, #ff6f3c);
      transition: width 0.08s ease;
    }

    .block.done .block-title {
      color: #0066cc;
    }

    .block.done .block-progress {
      color: #0066cc;
    }

    .result {
      font-size: 13px;
      color: #444;
      margin-bottom: 10px;
      min-height: 18px;
    }

    .controls {
      display: flex;
      justify-content: space-between;
      gap: 10px;
    }

    button {
      border-radius: 999px;
      border: none;
      padding: 8px 14px;
      font-size: 13px;
      cursor: pointer;
      font-weight: 600;
    }

.reset-btn {
      background: #f0f0f0;
      color: #555;
    }

    .clear-best-btn {
      background: #ffe5e8;
      color: #aa0011;
    }

    button:hover {
      opacity: 0.9;
    }

    @media (max-width: 480px) {
      .game-wrapper {
        padding: 16px;
      }
      .grid {
        gap: 8px;
      }
      .block {
        min-height: 80px;
      }
    }
  </style>
</head>
<body>
  <div class="game-wrapper">
    <div class="title">ë°©í•´ìš”ì¸ ë¶€ìˆ˜ê¸° ê²Œì„</div>
    <div class="subtitle">
      ë¹ ë¥¸ ì‹¤í–‰Â·ë¹ ë¥¸ ì‹¤íŒ¨ë¥¼ ë§‰ëŠ” 9ê°œì˜ ë¸”ë¡ì„<br>
      <b>í´ë¦­í•´ì„œ ë¶€ì…”ë³´ì„¸ìš”! (ê° ë¸”ë¡ 50í´ë¦­)</b>
    </div>

    <div class="status-bar">
      <div>âŒ› <span class="timer" id="timer">0.00s</span></div>
      <div class="best-time" id="bestTimeLabel">ìµœê³  ê¸°ë¡: -</div>
    </div>

    <div class="grid" id="blockGrid"></div>

    <div class="result" id="resultMsg"></div>

    <div class="controls">
      <button class="reset-btn" id="restartBtn">ë‹¤ì‹œ ì‹œì‘</button>
      <button class="clear-best-btn" id="clearBestBtn">ìµœê³  ê¸°ë¡ ì´ˆê¸°í™”</button>
    </div>
  </div>

  <script>
    // 1) ë¸”ë¡ í…ìŠ¤íŠ¸
    const blockLabels = [
      "ì™„ë²½ì£¼ì˜",
      "ëì—†ëŠ” íšŒì˜",
      "ë³´ê³  ë¼ì¸ ëˆˆì¹˜",
      "ì‹¤íŒ¨ì— ëŒ€í•œ ë‘ë ¤ì›€",
      "ì±…ì„ íšŒí”¼ ë¬¸í™”",
      "ê·œì •ë§Œ ë³´ëŠ” ì‹œì„ ",
      "ë°ì´í„° ì—†ìœ¼ë©´ ëª» í•´ìš”",
      "ê³ ê°ë³´ë‹¤ ë‚´ë¶€ ì‚¬ì • ìš°ì„ ",
      "â€œë‚˜ì¤‘ì— í•˜ìâ€ ìŠµê´€"
    ];

    const CLICKS_TO_BREAK = 50;
    const BEST_KEY = "fastFailBreaker_bestTime_v1";

    const gridEl = document.getElementById("blockGrid");
    const timerEl = document.getElementById("timer");
    const resultEl = document.getElementById("resultMsg");
    const bestTimeLabel = document.getElementById("bestTimeLabel");
    const restartBtn = document.getElementById("restartBtn");
    const clearBestBtn = document.getElementById("clearBestBtn");

    let blocks = [];
    let startTime = null;
    let timerInterval = null;
    let gameFinished = false;

    // ìµœê³  ê¸°ë¡ í‘œì‹œ
    function loadBestTime() {
      const best = localStorage.getItem(BEST_KEY);
      if (best) {
        bestTimeLabel.textContent = `ìµœê³  ê¸°ë¡: ${Number(best).toFixed(2)}s`;
      } else {
        bestTimeLabel.textContent = "ìµœê³  ê¸°ë¡: -";
      }
    }

    // íƒ€ì´ë¨¸ ì‹œì‘
    function startTimer() {
      if (startTime !== null) return;
      startTime = performance.now();
      timerInterval = setInterval(() => {
        if (startTime === null) return;
        const elapsed = (performance.now() - startTime) / 1000;
        timerEl.textContent = `${elapsed.toFixed(2)}s`;
      }, 30);
    }

    // íƒ€ì´ë¨¸ ì •ì§€
    function stopTimer() {
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
    }

    // ëª¨ë“  ë¸”ë¡ì´ ê¹¨ì¡ŒëŠ”ì§€ í™•ì¸
    function checkAllBroken() {
      return blocks.every(b => b.clicks >= CLICKS_TO_BREAK);
    }

    // ê²Œì„ ì´ˆê¸°í™”
    function initGame() {
      stopTimer();
      startTime = null;
      gameFinished = false;
      timerEl.textContent = "0.00s";
      resultEl.textContent = "";

      gridEl.innerHTML = "";
      blocks = [];

      blockLabels.forEach((label, idx) => {
        const block = document.createElement("div");
        block.className = "block";
        block.dataset.index = idx;

        block.innerHTML = `
          <div class="block-title">${label}</div>
          <div class="block-progress">0 / ${CLICKS_TO_BREAK} í´ë¦­</div>
          <div class="hp-bar">
            <div class="hp-fill"></div>
          </div>
        `;

        const blockObj = {
          el: block,
          titleEl: block.querySelector(".block-title"),
          progressEl: block.querySelector(".block-progress"),
          hpFillEl: block.querySelector(".hp-fill"),
          clicks: 0
        };

        block.addEventListener("click", () => handleBlockClick(blockObj));

        blocks.push(blockObj);
        gridEl.appendChild(block);
      });

      loadBestTime();
    }

    // ë¸”ë¡ í´ë¦­ ì²˜ë¦¬
    function handleBlockClick(blockObj) {
      if (gameFinished) return;

      // íƒ€ì´ë¨¸ëŠ” ì²« í´ë¦­ ì‹œ ì‹œì‘
      startTimer();

      if (blockObj.clicks >= CLICKS_TO_BREAK) return;

      blockObj.clicks += 1;

      const ratio = blockObj.clicks / CLICKS_TO_BREAK;
      blockObj.progressEl.textContent = `${blockObj.clicks} / ${CLICKS_TO_BREAK} í´ë¦­`;
 blockObj.hpFillEl.style.width = `${ratio * 100}%`;

      if (blockObj.clicks >= CLICKS_TO_BREAK) {
        blockObj.el.classList.add("done", "disabled");
        blockObj.progressEl.textContent = "ê¹¨ì§! âœ…";

        // ì „ë¶€ ë‹¤ ê¹¬ ê²½ìš°
        if (checkAllBroken()) {
          finishGame();
        }
      }
    }

    // ê²Œì„ ì¢…ë£Œ ì²˜ë¦¬
    function finishGame() {
      gameFinished = true;
      stopTimer();

      const elapsed = (performance.now() - startTime) / 1000;
      const elapsedFixed = elapsed.toFixed(2);
      resultEl.textContent = `ğŸ‰ ëª¨ë“  ë°©í•´ìš”ì¸ì„ ë¶€ì‰ˆìŠµë‹ˆë‹¤! ê¸°ë¡: ${elapsedFixed}s`;

      const best = localStorage.getItem(BEST_KEY);
      if (!best || elapsed < Number(best)) {
        localStorage.setItem(BEST_KEY, elapsed);
        bestTimeLabel.textContent = `ìµœê³  ê¸°ë¡: ${elapsedFixed}s (ì‹ ê¸°ë¡!)`;
        resultEl.textContent += "  ğŸ† ì‹ ê¸°ë¡ ë‹¬ì„±!";
      }

// ì´ë²¤íŠ¸
    restartBtn.addEventListener("click", initGame);

    clearBestBtn.addEventListener("click", () => {
      localStorage.removeItem(BEST_KEY);
      loadBestTime();
      resultEl.textContent = "ìµœê³  ê¸°ë¡ì„ ì´ˆê¸°í™”í–ˆìŠµë‹ˆë‹¤.";
    });

    // ì²« ë¡œë”©
    initGame();
  </script>
</body>
</html>